
N = 1000;

DT = 3600.00;      % time difference between sample points (s)

ETA_EL = 0.80;  % conversion factor of the electrolyser (kgH/s/W)

C_PV = 0.60;    % unit cost of PV ($/W)
C_W =  1.60;    % unit cost of Wind farm ($/W)
C_EL =  0.50;    % unit cost of electrolyser ($/W)
C_HS = 16.00;    % unit cost of hydrogen storage ($/kgH)

R_CAPA = 3600.00;       % reserved hydrogen for lowered capcaity factor
 
% Wind speed timeseries (m/s)
W = [4.0969, 3.9578, 3.8186, 3.6794, 4.4119, 3.4353, 1.0417, 2.625, 6.2453, 9.3333, 9.1667, 9.4583, 9.5417, 9.6897, 6.9722, 4.8936, 5.3103, 6.625, 5.6019, 5.2083, 4.7222, 4.7222, 4.7222, 4.7222, 4.7222, 4.7222, 4.7222, 4.7222, 4.2361, 3.0742, 4.7036, 4.9744, 4.9306, 4.97, 4.0369, 3.4492, 3.9444, 3.6528, 4.7756, 5.3772, 5.8936, 6.22, 4.7175, 3.0742, 2.6026, 2.8114, 3.0203, 3.2289, 3.4378, 3.6464, 3.8553, 4.0639, 4.2083, 5.4236, 5.1644, 6.8797, 8.4931, 8.4908, 7.5833, 7.78, 8.8056, 9.4258, 9.8356, 9.5625, 9.8147, 9.9769, 8.7825, 7.8658, 6.1453, 6.215, 6.2844, 6.3542, 6.4236, 6.4933, 6.5628, 6.6325, 6.4514, 6.0231, 6.0047, 6.4467, 7.0994, 5.4931, 5.3286, 5.7522, 6.5764, 6.375, 6.7917, 7.5, 8.4769, 8.3658, 8.3658, 7.4631, 7.5897, 7.2069, 6.8242, 6.4414, 6.0586, 5.6758, 5.2931, 4.9103, 4.4583, 3.0369, 3.2361, 6.5347, 6.9814, 6.2014, 4.8867, 4.5925, 4.9306, 4.7847, 6.1575, 7.1158, 7.1203, 7.3519, 6.6806, 6.0508, 6.41, 5.8881, 5.3661, 4.8442, 4.3225, 3.8006, 3.2786, 2.7566, 2.9536, 2.4398, 1.9074, 5.8242, 6.5, 5.9675, 5.9119, 5.9214, 6.0647, 6.3936, 6.9167, 6.7825, 6.8519, 6.7639, 5.3797, 5.0694, 3.5428, 3.4036, 3.2644, 3.1253, 2.9858, 2.8467, 2.7076, 2.5684, 3.4908, 4.125, 3.3611, 2.6551, 2.9214, 3.4814, 3.5092, 4.7592, 4.8658, 4.1667, 4.4028, 5.8194, 7.3381, 7.5833, 7.3703, 5.3472, 4.0469, 3.8033, 3.5597, 3.3161, 3.0728, 2.8292, 2.5855, 2.342, 0.18056, 0.0, 1.9537, 2.8797, 2.6528, 3.0925, 4.0833, 4.3703, 4.5464, 4.8381, 5.4306, 5.8842, 6.4492, 6.3381, 5.4814, 3.5278, 3.91, 3.3881, 2.8661, 2.3443, 1.8224, 1.3004, 0.77853, 0.25661, 1.5694, 10.3472, 14.0508, 12.8008, 13.1806, 8.3103, 8.8703, 8.9119, 8.6667, 7.4769, 6.8056, 8.6806, 5.125, 4.5556, 3.5556, 5.6897, 3.91, 3.3881, 2.8661, 2.3443, 1.8224, 1.3004, 0.77853, 0.25661, 0.0, 0.0, 0.37036, 2.3287, 2.3889, 2.8381, 3.4397, 3.7408, 5.125, 6.6297, 6.5047, 5.5881, 6.7825, 6.75, 4.8103, 3.9353, 4.3981, 3.5742, 3.1644, 3.5508, 4.1342, 5.1297, 9.1158, 12.6111, 11.6944, 13.6897, 14.9397, 15.5325, 15.2869, 14.7131, 16.1436, 15.7964, 15.8056, 15.7314, 15.3842, 14.4444, 11.4444, 9.8703, 10.3564, 8.0, 8.6111, 4.8056, 5.3286, 4.6436, 7.5464, 5.3564, 4.0278, 3.4631, 3.5464, 3.7592, 4.3889, 6.6436, 5.4536, 4.3333, 4.25, 4.1158, 4.1992, 4.5464, 5.2083, 6.8147, 7.4444, 5.6806, 5.8564, 6.1297, 4.6897, 4.5369, 3.3889, 2.875, 0.46297, 1.9907, 1.8889, 2.3241, 3.4444, 4.0742, 4.1389, 3.5186, 2.7685, 2.0741, 2.3611, 2.4167, 4.6619, 7.4675, 7.5833, 7.1619, 6.7917, 5.8147, 6.1806, 4.1111, 3.4119, 4.1992, 5.0647, 4.6806, 3.1342, 2.0648, 2.7315, 3.6853, 4.9119, 5.2222, 4.7686, 2.4954, 2.25, 1.9028, 4.3519, 4.8194, 6.6436, 8.9167, 10.4908, 9.3658, 8.1806, 7.7825, 6.2778, 7.0694, 5.2869, 3.8242, 4.0186, 4.6714, 3.8842, 3.3889, 3.1111, 2.9214, 2.1481, 1.8102, 1.5463, 2.2408, 2.7222, 2.7407, 3.7222, 3.375, 5.2131, 4.4861, 4.4492, 5.3519, 7.4028, 4.7825, 7.25, 7.3056, 5.375, 3.7453, 2.2037, 1.8611, 2.4074, 2.8008, 3.8425, 5.7175, 5.6575, 4.7269, 6.6064, 7.2731, 7.1806, 5.5972, 5.2222, 5.9214, 6.4075, 7.7964, 6.5833, 6.8797, 7.9397, 8.3472, 8.7222, 8.2917, 5.2175, 2.463, 3.7131, 4.1389, 3.3889, 3.2408, 3.7131, 3.6019, 2.9258, 3.0186, 4.3103, 5.5508, 6.0556, 5.5231, 5.4444, 5.0, 4.9908, 5.6897, 5.1297, 6.2964, 6.8842, 7.1853, 7.7083, 6.7408, 6.4953, 5.875, 5.3797, 4.6111, 4.4353, 5.0, 4.7547, 4.1481, 3.6019, 4.0186, 3.2778, 3.6111, 3.8936, 3.6019, 2.8981, 2.7825, 2.6065, 3.375, 4.4583, 5.3842, 6.8658, 7.2869, 5.75, 4.6758, 3.5769, 3.5072, 3.4378, 3.3681, 3.2986, 3.2289, 3.1594, 3.0897, 3.1019, 2.0926, 4.7269, 8.9722, 10.1064, 11.25, 9.6619, 9.8425, 9.4953, 10.0464, 9.6575, 8.4908, 8.4375, 8.1944, 8.2917, 6.7547, 5.5556, 6.1389, 6.4119, 8.4536, 2.7869, 2.6528, 0.31019, 2.1991, 2.4907, 3.0231, 3.8008, 4.0417, 3.2314, 2.7269, 4.6297, 3.0047, 4.0464, 6.3658, 8.3936, 8.3103, 7.7686, 8.2222, 6.5742, 6.3519, 6.0603, 4.5092, 4.8425, 4.75, 3.7778, 4.4119, 5.6714, 6.4028, 4.6619, 4.8658, 4.4908, 5.2686, 5.2083, 3.7869, 3.4306, 3.5231, 4.5742, 4.7825, 6.1806, 7.75, 7.1992, 6.6342, 7.0278, 5.8472, 4.5972, 3.8981, 3.4353, 3.4814, 2.7269, 1.875, 2.1296, 2.1019, 2.2083, 2.4213, 1.7037, 2.9675, 3.625, 3.7269, 4.1458, 5.0925, 5.0925, 5.3519, 6.4583, 6.8194, 7.5881, 7.9397, 7.1528, 6.4536, 5.7361, 4.5925, 3.8797, 2.8333, 2.6065, 3.4444, 4.0092, 2.3796, 1.9907, 1.912, 2.7083, 2.9444, 3.3194, 3.3936, 4.5694, 4.8056, 6.4953, 6.6436, 7.0508, 8.6019, 8.7175, 7.8519, 7.3842, 7.2825, 4.8425, 4.8056, 4.4397, 4.5325, 4.8981, 4.8103, 4.8008, 4.4258, 4.5881, 4.5464, 3.4167, 3.0925, 3.4492, 3.8333, 3.6297, 3.7731, 4.0278, 4.2825, 4.4306, 5.4675, 6.4119, 6.8564, 5.9631, 5.0047, 4.8461, 4.5328, 4.2197, 3.9067, 3.5933, 3.2803, 2.9672, 2.654, 2.463, 3.5925, 3.9908, 3.6389, 2.5602, 1.9769, 2.5741, 3.4028, 5.0325, 7.8264, 7.3936, 6.0508, 5.5972, 4.6436, 4.0972, 3.6389, 3.9814, 3.7036, 2.4861, 2.8056, 4.8842, 5.4306, 7.5694, 8.3519, 8.6389, 7.8981, 10.3286, 13.3103, 12.6436, 11.8103, 10.9353, 9.5786, 9.3381, 8.5694, 7.8056, 7.0, 7.3056, 6.3564, 5.5464, 3.4536, 5.5603, 7.1714, 3.3147, 2.5602, 4.4722, 3.7731, 7.2083, 6.6667, 4.7917, 2.7917, 2.1944, 2.25, 3.6897, 4.7083, 4.1111, 4.0972, 4.9769, 4.3564, 4.7083, 4.6897, 3.6019, 4.0417, 3.3658, 2.6435, 0.93519, 2.2546, 2.2454, 2.9675, 2.0463, 2.2176, 4.3889, 5.0833, 5.0556, 5.0231, 5.6342, 9.4028, 12.4167, 12.4814, 10.2825, 10.3333, 8.6481, 6.5786, 7.9814, 8.6806, 6.7686, 6.6667, 4.3564, 3.0694, 2.1296, 1.2037, 3.2686, 3.4353, 4.25, 3.0, 2.7083, 1.9815, 2.3102, 3.3425, 3.6297, 5.3242, 4.0833, 3.1667, 3.2778, 3.0647, 3.5369, 4.3147, 3.5464, 4.3103, 4.6481, 4.7408, 4.5231, 3.7547, 2.6806, 2.3935, 2.25, 1.9398, 2.4167, 0.10185, 1.125, 1.8333, 3.1158, 3.5464, 3.3056, 3.7408, 3.9353, 3.5972, 4.1436, 3.0694, 3.3147, 4.9722, 5.2361, 5.2408, 5.6158, 6.0742, 6.8797, 5.5231, 3.2869, 2.4167, 3.0047, 2.5093, 3.0186, 2.5463, 2.9953, 2.6296, 2.8889, 4.1481, 3.9258, 3.7314, 3.0556, 3.0047, 5.3564, 5.3936, 5.7453, 5.8519, 5.625, 6.2083, 7.1111, 7.1019, 5.2408, 4.9908, 4.7222, 4.7222, 4.7222, 4.7222, 4.7222, 4.7222, 4.7222, 4.7222, 4.5833, 5.2361, 5.0278, 5.6944, 6.3194, 6.8842, 6.9492, 7.5508, 7.2036, 6.9908, 7.8381, 8.0047, 8.6342, 8.5278, 8.9214, 7.9722, 7.2825, 7.5786, 6.8842, 7.5786, 6.125, 6.2547, 6.2639, 4.7083, 4.3703, 4.5231, 4.4675, 4.4119, 4.8703, 5.9769, 5.9769, 5.4119, 6.1436, 7.5972, 7.125, 7.5556, 8.625, 8.6436, 8.3242, 7.5369, 6.7269, 6.4397, 6.1944, 5.4861, 4.8703, 4.8147, 4.5231, 4.5, 4.1481, 3.8519, 4.125, 4.3194, 3.5417, 3.1619, 3.9953, 4.2825, 5.0603, 5.9769, 6.1853, 6.8889, 8.6019, 7.8797, 7.4536, 6.6575, 7.1575, 7.0972, 5.9861, 5.8381, 5.5139, 5.4028, 6.5556, 6.5603, 5.8103, 6.8728, 7.0786, 7.0881, 6.5231, 8.1064, 9.3056, 7.3103, 8.3611, 8.3425, 7.5786, 8.0508, 8.3703, 7.9675, 7.4214, 6.1389, 5.0139, 5.0047, 4.9536, 3.0092, 2.4907, 2.4259, 2.5278, 2.3981, 2.537, 2.8611, 2.8981, 1.3657, 2.088, 2.3981, 2.4537, 3.1667, 3.5925, 4.625, 5.1992, 6.7778, 7.5694, 7.4769, 6.6111, 5.6019, 4.5325, 4.4028, 4.9258, 4.9492, 4.7592, 4.6944, 3.8333, 3.2036, 2.875, 3.0325, 3.1203, 2.8703, 3.6203, 7.0139, 6.4583, 6.9675, 6.2269, 5.6481, 4.3147, 2.3889, 4.1389, 4.9722, 4.6436, 6.7869, 6.9142, 6.2881, 5.6617, 5.0353, 4.4092, 3.7828, 3.1564, 2.5302, 1.6389, 1.4074, 1.6088, 2.2222, 2.0926, 2.6806, 3.8772, 4.5694, 5.1644, 6.4375, 7.9214, 8.9306, 9.1342, 9.03, 7.9583, 7.4631, 7.9075, 7.9306, 7.5881, 6.875, 6.7269, 6.1297, 7.0464, 7.5231, 6.5742, 3.7453, 4.6944, 6.2131, 5.8981, 5.3797, 5.0047, 6.1203, 6.4769, 6.2917, 5.4631, 6.7222, 7.7964, 8.4119, 7.7408, 6.5603, 6.9722, 6.3472, 6.6064, 7.2175, 5.9167, 5.6203, 5.1342, 4.1897, 3.7222, 3.4722, 4.2036, 6.1389, 6.7869, 5.7269, 5.4583, 4.7639, 4.5, 5.0139, 4.9583, 5.5972, 6.0278, 6.5186, 6.1297, 3.6389, 3.3425, 3.3611, 4.1389, 4.3472, 3.7917, 4.1806, 3.8242, 4.0278, 3.4814, 3.0278, 2.8472, 2.4907, 1.9954, 4.2222, 6.6389, 5.5786, 6.4631, 6.2131, 5.9167, 7.0325, 7.2036, 6.9675, 6.0881, 4.4583, 3.5464, 3.9258, 3.8056, 2.9167, 2.1435, 1.7454, 2.5926, 2.8564, 2.2546, 1.2315, 2.5509, 4.5139, 9.7175, 9.2869, 7.7547, 6.2964, 6.375, 5.1944, 8.2686, 6.8519]; 

% solar radiation timeseries (W/m2)                            
S = [0.63856, 0.45568, 0.2728, 0.089916, 0.9055, 18.524, 103.9, 198.24, 369.37, 480.37, 285.28, 258.89, 94.877, 50.675, 57.861, 78.462, 66.394, 38.892, 26.509, 4.027, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.33033, 42.045, 172.48, 352.69, 315.19, 544.33, 742.54, 1025.3, 1055.1, 1033.9, 942.18, 793.66, 611.01, 404.26, 193.74, 32.302, 2.4774, 2.1467, 1.816, 1.4853, 1.1547, 0.82397, 0.49328, 0.16259, 0.073167, 10.146, 53.097, 217.14, 532.08, 648.72, 624.4, 815.39, 944.22, 997.21, 960.36, 765.43, 594.17, 331.04, 144.37, 36.129, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.11867, 32.999, 104.77, 231.45, 235.03, 290.36, 379.78, 554.36, 626.81, 782.04, 726.45, 710.62, 480.75, 265.51, 156.44, 16.21, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.12617, 42.374, 222.82, 436.22, 640.88, 783.48, 904.04, 969.13, 1090.1, 1046.0, 934.51, 799.32, 625.63, 374.06, 133.61, 20.371, 2.0364, 1.7645, 1.4927, 1.2209, 0.94909, 0.67728, 0.40546, 0.13364, 0.056833, 44.715, 218.78, 402.67, 511.69, 833.51, 979.1, 1064.7, 1090.3, 1052.9, 933.97, 666.04, 447.15, 278.21, 108.91, 34.89, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.085667, 20.344, 56.135, 203.72, 583.43, 766.08, 920.52, 1020.8, 1054.8, 1019.5, 930.43, 792.55, 614.98, 409.39, 199.3, 35.784, 1.3044, 1.1303, 0.95617, 0.78206, 0.60794, 0.43383, 0.25972, 0.085605, 0.1965, 27.547, 146.72, 343.04, 631.2, 806.82, 942.04, 1027.9, 1057.6, 1031.5, 943.89, 805.08, 625.8, 419.95, 118.54, 16.171, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.926, 73.664, 121.73, 96.11, 188.57, 322.88, 289.34, 381.3, 405.66, 250.22, 124.66, 121.27, 128.17, 61.224, 13.528, 1.6798, 1.4555, 1.2313, 1.0071, 0.78289, 0.55867, 0.33446, 0.11024, 0.0, 31.429, 192.12, 334.9, 320.47, 444.51, 850.54, 982.54, 963.45, 880.42, 787.01, 178.37, 41.522, 58.207, 26.16, 3.5687, 0.093833, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.042833, 20.466, 91.285, 341.44, 646.06, 555.14, 862.92, 943.18, 1029.6, 1038.6, 919.01, 753.79, 370.55, 185.0, 174.15, 15.363, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.022, 106.2, 311.23, 600.48, 827.2, 974.04, 1055.2, 1086.3, 1054.1, 951.85, 804.8, 617.78, 403.84, 187.98, 29.474, 0.065667, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 27.124, 188.77, 411.37, 629.17, 814.05, 960.41, 1053.3, 1091.8, 1072.6, 982.07, 835.51, 650.41, 427.96, 203.6, 33.825, 0.94383, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 26.839, 181.63, 403.28, 615.38, 769.05, 942.54, 1026.7, 1031.5, 1035.3, 853.59, 629.29, 430.52, 124.55, 68.65, 7.0912, 0.034833, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.7367, 11.784, 81.469, 106.43, 71.917, 61.021, 172.71, 174.19, 322.76, 519.4, 450.04, 382.79, 242.65, 54.494, 11.047, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.713, 110.54, 238.95, 411.35, 502.5, 602.65, 525.26, 815.2, 852.33, 726.72, 496.23, 447.46, 295.13, 242.13, 32.197, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 23.767, 79.346, 271.97, 409.97, 425.27, 320.15, 510.23, 778.36, 777.17, 870.89, 758.51, 619.09, 398.2, 151.0, 12.067, 0.033833, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.6685, 26.07, 108.02, 138.14, 270.29, 520.33, 1052.5, 1053.3, 1025.4, 935.01, 791.7, 609.99, 398.64, 181.52, 27.42, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.135, 168.13, 257.72, 445.54, 770.61, 741.0, 992.87, 1023.8, 994.22, 895.96, 695.62, 579.94, 391.46, 181.51, 24.121, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.9172, 10.218, 30.373, 109.98, 152.88, 262.5, 385.35, 778.17, 905.54, 795.84, 636.55, 534.59, 374.3, 115.02, 22.887, 0.018667, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.1263, 164.65, 243.3, 267.96, 646.61, 843.48, 1024.8, 1063.5, 1037.0, 948.46, 757.53, 572.4, 439.38, 179.19, 25.979, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.4895, 109.01, 340.94, 501.99, 594.02, 635.76, 542.8, 791.69, 918.68, 817.12, 779.34, 624.77, 404.79, 186.06, 26.599, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.412, 89.662, 356.92, 606.04, 787.02, 942.73, 1050.3, 1018.5, 1051.8, 955.36, 808.04, 622.04, 404.55, 184.64, 26.107, 0.11667, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.4785, 38.143, 144.68, 218.23, 340.36, 693.21, 1012.0, 1035.3, 1013.1, 924.03, 786.2, 601.32, 391.13, 176.15, 24.335, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.017, 140.51, 345.39, 548.14, 734.67, 886.74, 978.86, 1015.2, 1013.7, 922.09, 782.88, 594.3, 377.74, 168.31, 22.474, 0.096833, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.893, 139.07, 350.16, 559.08, 768.8, 777.45, 720.91, 708.97, 596.51, 541.94, 415.06, 415.6, 181.92, 75.35, 9.6477, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.103, 53.312, 227.81, 470.93, 528.31, 499.34, 549.2, 813.98, 709.11, 417.27, 335.53, 446.16, 115.31, 41.733, 2.912, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.3063, 130.77, 328.8, 551.57, 705.3, 773.98, 968.89, 957.31, 628.91, 124.2, 122.27, 205.71, 201.06, 65.378, 14.24, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.7963, 17.628, 22.391, 39.213, 59.016, 104.36, 94.993, 103.43, 106.28, 147.52, 77.249, 65.569, 46.67, 25.181, 1.5397, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.5155, 67.392, 299.06, 338.95, 521.88, 487.78, 982.88, 1028.9, 998.88, 913.44, 772.03, 591.47, 380.37, 166.47, 19.034, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.7857, 135.65, 349.95, 551.91, 709.79, 899.35, 991.47, 1022.4, 1004.6, 919.64, 774.39, 587.49, 372.57, 156.08, 17.716, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.4175, 29.979, 115.35, 206.96, 292.76, 268.39, 462.78, 214.53, 128.2, 246.86, 232.89, 162.0, 71.045, 34.298, 3.0727, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0205, 43.611, 80.849, 133.77, 385.88, 823.54, 980.26, 855.2, 753.3, 617.95, 497.64, 465.41, 201.43, 87.767, 12.939, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.86, 16.824, 79.947, 206.31, 525.47, 879.8, 985.09, 1027.4, 995.98, 901.59, 766.22, 569.94, 264.12, 55.848, 4.9485, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.4943, 30.471, 137.23, 139.62, 371.28, 328.47, 255.92, 477.12, 788.49, 916.87, 776.84, 588.33, 370.21, 152.79, 14.162, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.7795, 114.33, 316.24, 531.87, 725.02, 872.41, 963.05, 993.88, 975.14, 893.91, 755.24, 567.69, 354.9, 145.68, 13.432, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0152, 110.83, 311.9, 523.87, 715.56, 867.16, 967.13, 999.52, 938.8, 706.69, 402.76, 426.0, 339.16, 91.339, 15.018, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.2665, 31.856, 114.87, 190.13, 505.07, 858.63, 968.08, 1004.1, 976.38, 889.2, 750.4, 421.41, 119.08, 22.763, 1.306, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.8343, 91.422, 166.03, 162.34, 131.34, 115.93, 161.29, 319.39, 487.79, 833.09, 725.53, 381.29, 249.75, 124.21, 6.8073, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.2848, 116.74, 364.71, 534.85, 726.45, 876.69, 972.04, 1005.9, 979.51, 893.23, 746.47, 556.85, 342.51, 132.68, 9.482, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.6858, 96.04, 293.18, 508.73, 704.0, 854.49, 953.06, 975.93, 946.48, 858.96, 715.12, 530.52, 322.11, 120.25, 8.4317, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.8107, 87.663, 292.05, 463.02, 691.27, 874.62, 826.51, 743.44, 710.95, 728.68, 656.62]; 

% load timeseries (kgH/s)                             
L = [0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1];                              
